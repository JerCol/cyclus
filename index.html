<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Attendance Page</title>
  <!--
    ðŸ‘‰ Replace YOUR_IMAGE.jpg with your chosen background image.
    ðŸ‘‰ Replace SHEET_ENDPOINT with your Apps Script Web App URL.
  -->
  <style>
    /* Reset and base */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; font-family: system-ui, sans-serif; }

    /* Full-screen background */
    body {
      background: url('YOUR_IMAGE.jpg') center/cover no-repeat;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #222;
    }

    /* Counter top-right */
    #counter {
      position: fixed;
      top: 16px;
      right: 16px;
      font-size: 1.5rem;
      background: rgba(255,255,255,0.8);
      padding: 4px 8px;
      border-radius: 4px;
    }

    /* Name wall top-left */
    #nameWall {
      position: fixed;
      top: 16px;
      left: 16px;
      font-size: 10px;
      line-height: 12px;
      color: #444;
      white-space: pre-wrap;
      word-break: break-word;
      max-width: calc(100% - 32px);
    }

    /* Centered form */
    form {
      width: 90%;
      max-width: 360px;
      background: rgba(255,255,255,0.9);
      padding: 16px;
      border: 1px solid #ccc;
      border-radius: 4px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    form input,
    form button {
      font-size: 1rem;
      padding: 8px;
      border: 1px solid #888;
      border-radius: 4px;
    }
    form button {
      background: #fff;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <!-- Counter -->
  <div id="counter">0</div>

  <!-- Scrolling names -->
  <div id="nameWall"></div>

  <!-- Centered attendance form -->
  <form id="attendForm" autocomplete="off">
    <input type="text" name="name" placeholder="Your name (optional)">
    <input type="tel" name="phone" placeholder="Phone (optional)">
    <button type="submit">I attend</button>
  </form>

  <script>
    const SHEET_ENDPOINT = 'https://script.google.com/macros/s/XXXXXXXXXXXXXXXXXXXXXXXX/exec';

    function addQs(url, params) {
      return url + '?' + new URLSearchParams(params);
    }

    async function fetchNames() {
      const res = await fetch(addQs(SHEET_ENDPOINT, { action: 'read' }));
      const list = await res.json();
      render(list);
    }

    async function writeName(name, phone) {
      const res = await fetch(addQs(SHEET_ENDPOINT, { action: 'write', name, phone }));
      const list = await res.json();
      render(list);
    }

    function render(list) {
      document.getElementById('counter').textContent = list.length;
      document.getElementById('nameWall').textContent = list.map(o => o.name || 'Anonymous').join('\u00a0');
    }

    document.getElementById('attendForm').addEventListener('submit', e => {
      e.preventDefault();
      const fd = new FormData(e.target);
      writeName(fd.get('name').trim(), fd.get('phone').trim());
      e.target.reset();
    });

    fetchNames();
  </script>
</body>
</html>
