<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Attendance Page</title>
  <!--
    ðŸ‘‰ Replace YOUR_IMAGE.jpg with the image you want in the same repository.
    ðŸ‘‰ Replace SHEET_ENDPOINT below with the URL of your GoogleÂ AppsÂ Script Webâ€¯App.
  -->
  <style>
    /* --- Basic layout --- */
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:#f2f2f2;color:#222;display:flex;flex-direction:column;align-items:center}
    
    /* --- Header picture --- */
    .hero-wrapper{position:relative;width:100%;max-width:1000px}
    .hero-wrapper img{width:100%;max-height:60vh;object-fit:cover;display:block}

    /* --- Counter at topâ€‘right --- */
    #counter{position:absolute;top:12px;right:16px;padding:4px 10px;font-size:1.75rem;font-weight:600;background:#ffffffcc;border-radius:8px;backdrop-filter:blur(6px)}

    /* --- Tiny name wall --- */
    #nameWall{position:absolute;top:12px;left:16px;width:calc(100% - 32px);font-size:10px;line-height:12px;color:#444;pointer-events:none;white-space:pre-wrap;word-break:break-word}

    /* --- Form --- */
    form{width:100%;max-width:420px;margin:32px auto;padding:16px;background:#fff;border-radius:12px;box-shadow:0 4px 10px #0001;display:flex;flex-direction:column;gap:12px}
    form input{padding:10px;border:1px solid #ccc;border-radius:8px;font-size:1rem;width:100%}
    form button{padding:12px;border:none;border-radius:8px;font-size:1rem;font-weight:600;background:#007bff;color:#fff;cursor:pointer;transition:background .2s}
    form button:hover{background:#0366d6}
    @media(max-width:480px){#counter{font-size:1.3rem}}
  </style>
</head>
<body>
  <div class="hero-wrapper">
    <!-- Your picture -->
    <img src="YOUR_IMAGE.jpg" alt="Event banner" />

    <!-- Counter -->
    <div id="counter">0</div>

    <!-- Scrolling list of names -->
    <div id="nameWall"></div>
  </div>

  <!-- Attendance form -->
  <form id="attendForm" autocomplete="off">
    <input type="text" name="name" placeholder="Your name (optional)" />
    <input type="tel" name="phone" placeholder="Phone (optional)" />
    <button type="submit">I attend</button>
  </form>

  <script>
  // === CONFIGURATION ===
  // 1. After you deploy an Apps Script as a Webâ€¯App (see README below), paste the URL here.
  const SHEET_ENDPOINT = 'https://script.google.com/macros/s/XXXXXXXXXXXXXXXXXXXXXXXX/exec';

  // === HELPER FUNCTIONS ===
  async function fetchNames(){
    try{
      const res = await fetch(`${SHEET_ENDPOINT}?action=read`);
      const list = await res.json();
      if(Array.isArray(list)) renderNames(list);
    }catch(err){console.error('Fetch error', err);}
  }

  function renderNames(list){
    // Update counter
    document.getElementById('counter').textContent = list.length;

    // Build one long string; browsers wrap automatically
    const namesString = list.map(o => (o.name || 'Anonymous')).join(' \u00a0'); // \u00a0 = noâ€‘break space
    document.getElementById('nameWall').textContent = namesString;
  }

  async function writeName(payload){
    const res = await fetch(SHEET_ENDPOINT, {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify(payload)
    });
    return res.json();
  }

  // === EVENT LISTENERS ===
  document.getElementById('attendForm').addEventListener('submit', async e => {
    e.preventDefault();
    const fd = new FormData(e.target);
    const payload = {
      action:'write',
      name: fd.get('name').trim(),
      phone: fd.get('phone').trim()
    };
    try{
      const updated = await writeName(payload);
      renderNames(updated);
      e.target.reset();
    }catch(err){
      alert('Sorry, something went wrong.');
      console.error(err);
    }
  });

  // Initial population
  fetchNames();
  </script>

  <!--
  ===================================
  ðŸ“‘  BACKEND (GoogleÂ AppsÂ Script)  ðŸ“‘
  ===================================
  1. In GoogleÂ Sheets â‡’ Extensions â‡’ AppsÂ Script, paste the code below.
  2. Replace YOUR_SHEET_ID with your Sheet ID (from the URL).
  3. Deploy â‡’ New deployment â‡’ WebÂ App.
     - Who has access: Anyone
     - Execute as: Me (or whichever account owns the Sheet)
  4. Copy the WebÂ App URL and paste it into SHEET_ENDPOINT above.
  5. The free quota is ~90Â minutes/day and 20k calls/day (sufficient for small events).

  ----- AppsÂ Script code -----
  const SHEET_ID = 'YOUR_SHEET_ID';
  const SHEET_NAME = 'Sheet1'; // change if needed

  function getSheet(){
    return SpreadsheetApp.openById(SHEET_ID).getSheetByName(SHEET_NAME);
  }

  function doGet(){
    const data = getSheet().getDataRange().getValues().slice(1) // skip header
      .map(r => ({ name: r[0], phone: r[1], timestamp: r[2] }));
    return ContentService.createTextOutput(JSON.stringify(data))
      .setMimeType(ContentService.MimeType.JSON)
      .setHeader('Access-Control-Allow-Origin', '*');
  }

  function doPost(e){
    const body = JSON.parse(e.postData.contents);
    getSheet().appendRow([body.name || '', body.phone || '', new Date()]);
    return doGet(); // respond with full list so UI can refresh
  }
  ---------------------------------

  ðŸ†“  100% free under default quotas. If you expect heavy traffic (>100Â submissions/minute or >20Â k/day),
      consider a free-tier database such as Supabase or Firebase (see README).
  -->
</body>
</html>
